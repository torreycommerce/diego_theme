$(function(){function e(e){var s={visa:/^4[0-9]{12}(?:[0-9]{3})?$/,mastercard:/^5[1-5][0-9]{14}$/,amex:/^3[47][0-9]{13}$/,discover:/^6(?:011|5[0-9]{2})[0-9]{12}$/};return s.visa.test(e)?"visa":s.mastercard.test(e)?"mastercard":s.amex.test(e)?"amex":s.discover.test(e)?"discover":!1}var s=$("form[name=checkout],form[name=express],form[name=shipping]"),t=s.attr("name"),i=$("input[name=step]").val();s.attachNormalizer({formPrefix:i}),s.submit(function(){return console.log(s.normalized),console.log($("#custom-address").is(":hidden")),$(".form-horizontal").parsley("isValid")?void(s.normalized&&!$("#custom-address").is(":hidden")?$(this).find('button[type="submit"]').attr("disabled",!0):void 0!=s.normalized||!$("#custom-address").is(":hidden")&&$("#custom-address").length||$(this).find('button[type="submit"]').attr("disabled",!0)):!1}),(""!=$("#checkout_shipping_address_id").val()&&void 0!=$("#checkout_shipping_address_id").val()||""!=$("#checkout_billing_address_id").val()&&void 0!=$("#checkout_billing_address_id").val()||""!=$("#express_shipping_address_id").val()&&void 0!=$("#express_shipping_address_id").val())&&($("#custom-address").hide(),$('#custom-address input[type="text"], #custom-address input[type="tel"]').each(function(e,s){$(this).parsley("removeConstraint","required")})),$("#checkout_shipping_address_id, #checkout_billing_address_id, #express_shipping_address_id").change(function(){""!=$(this).val()?($("#custom-address").slideUp(),$('#custom-address input[type="text"], #custom-address input[type="tel"]').each(function(e,s){$(this).parsley("removeConstraint","required")})):($("#custom-address").slideDown(),$('#custom-address input[type="text"], #custom-address input[type="tel"]').each(function(e,s){-1===s.name.indexOf("street_line2")&&$(this).parsley("addConstraint",{required:!0})}))}),$("#checkout_card_number").keyup(function(){var s=e($(this).val());$(".cc-visa,.cc-mastercard,.cc-amex,.cc-discover").fadeTo(0,.4),s&&$(".cc-"+s).fadeTo(0,1)})});