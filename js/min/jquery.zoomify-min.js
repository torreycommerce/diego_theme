/**
 * @license jquery.panzoom.js v1.6.6
 * Updated: Wed Aug 28 2013
 * Add pan and zoom functionality to any element
 * Copyright (c) 2013 timmy willison
 * Released under the MIT license
 * https://github.com/timmywil/jquery.panzoom/blob/master/MIT-License.txt
 */
!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):e(t.jQuery)}(this,function($){"use strict";function t(t){var e={range:!0,animate:!0};return"boolean"==typeof t?e.animate=t:$.extend(e,t),e}function e(t,e,n,i,s,o,a,r,h){"array"===$.type(t)?this.elements=[+t[0],+t[2],+t[4],+t[1],+t[3],+t[5],0,0,1]:this.elements=[t,e,n,i,s,o,a||0,r||0,h||1]}function n(t,e,n){this.elements=[t,e,n]}function i(t,e){1!==t.nodeType&&$.error("Panzoom called on non-Element node"),$.contains(document,t)||$.error("Panzoom element must be attached to the document");var n=$.data(t,o);if(n)return n;if(!(this instanceof i))return new i(t,e);this.options=e=$.extend({},i.defaults,e),this.elem=t;var s=this.$elem=$(t);this.$doc=$(t.ownerDocument||document),this.$parent=s.parent(),this.isSVG=h.test(t.namespaceURI)&&"svg"!==t.nodeName.toLowerCase(),this.panning=!1,this._buildTransform(),this.isSVG||(this._transform=$.cssProps.transform.replace(r,"-$1").toLowerCase()),this._buildTransition(),this._buildContain();var a=$(),c=this;$.each(["$zoomIn","$zoomOut","$zoomRange","$reset"],function(t,n){c[n]=e[n]||a}),this.enable(),$.data(t,o,this)}var s={props:["touches","pageX","pageY"],filter:function(t,e){var n;return!e.pageX&&e.touches&&(n=e.touches[0])&&(t.pageX=n.pageX,t.pageY=n.pageY),t}};$.each(["touchstart","touchmove","touchend"],function(t,e){$.event.fixHooks[e]=s});var o="__pz__",a=Array.prototype.slice,r=/([A-Z])/g,h=/^http:[\w\.\/]+svg$/,c="(\\-?[\\d\\.e]+)",l="\\,?\\s*",u=new RegExp("^matrix\\("+c+l+c+l+c+l+c+l+c+l+c+"\\)$");return e.prototype={x:function(t){var i=t instanceof n,s=this.elements,o=t.elements;return i&&3===o.length?new n(s[0]*o[0]+s[1]*o[1]+s[2]*o[2],s[3]*o[0]+s[4]*o[1]+s[5]*o[2],s[6]*o[0]+s[7]*o[1]+s[8]*o[2]):o.length===s.length?new e(s[0]*o[0]+s[1]*o[3]+s[2]*o[6],s[0]*o[1]+s[1]*o[4]+s[2]*o[7],s[0]*o[2]+s[1]*o[5]+s[2]*o[8],s[3]*o[0]+s[4]*o[3]+s[5]*o[6],s[3]*o[1]+s[4]*o[4]+s[5]*o[7],s[3]*o[2]+s[4]*o[5]+s[5]*o[8],s[6]*o[0]+s[7]*o[3]+s[8]*o[6],s[6]*o[1]+s[7]*o[4]+s[8]*o[7],s[6]*o[2]+s[7]*o[5]+s[8]*o[8]):!1},inverse:function(){var t=1/this.determinant(),n=this.elements;return new e(t*(n[8]*n[4]-n[7]*n[5]),t*-(n[8]*n[1]-n[7]*n[2]),t*(n[5]*n[1]-n[4]*n[2]),t*-(n[8]*n[3]-n[6]*n[5]),t*(n[8]*n[0]-n[6]*n[2]),t*-(n[5]*n[0]-n[3]*n[2]),t*(n[7]*n[3]-n[6]*n[4]),t*-(n[7]*n[0]-n[6]*n[1]),t*(n[4]*n[0]-n[3]*n[1]))},determinant:function(){var t=this.elements;return t[0]*(t[8]*t[4]-t[7]*t[5])-t[3]*(t[8]*t[1]-t[7]*t[2])+t[6]*(t[5]*t[1]-t[4]*t[2])}},n.prototype.e=e.prototype.e=function(t){return this.elements[t]},i.rmatrix=u,i.defaults={eventNamespace:".panzoom",transition:!0,cursor:"move",disablePan:!1,disableZoom:!1,increment:.3,minScale:.4,maxScale:5,duration:200,easing:"ease-in-out",contain:!1},i.prototype={constructor:i,instance:function(){return this},enable:function(){this._initStyle(),this._bind(),this.disabled=!1},enablePan:function(){this.options.disablePan=!1,this.options.silent=!1},disablePan:function(){this.options.disablePan=!0,this.options.silent=!0},disable:function(){this.disabled=!0,this._resetStyle(),this._unbind()},isDisabled:function(){return this.disabled},getScale:function(){return"undefined"==typeof this.scale&&(this.scale=1),this.scale},destroy:function(){this.disable(),$.removeData(this.elem,o)},reset:function(e){e=t(e);var n=this.setMatrix(this._origTransform,e);e.silent||this._trigger("reset",n)},resetZoom:function(e){e=t(e);var n=this.getMatrix(this._origTransform);e.dValue=n[3],this.zoom(n[0],e)},resetPan:function(e){var n=this.getMatrix(this._origTransform);this.pan(n[4],n[5],t(e))},getTransform:function(t){var e=this.elem,n=this.isSVG?"attr":"style";return t?$[n](e,"transform",t):t=$[n](e,"transform"),"none"===t||u.test(t)||this.isSVG||(t=$.css(e,"transform"),$.style(e,"transform",t)),t||"none"},getMatrix:function(t){var e=u.exec(t||this.getTransform());return e&&e.shift(),e||[1,0,0,1,0,0]},setMatrix:function(t,e){if(!this.disabled){e||(e={}),"string"==typeof t&&(t=this.getMatrix(t));var n,i,s,o,a,r,h=+t[0],c="undefined"!=typeof e.contain?e.contain:this.options.contain;return this.scale=h,c&&(n=this._checkDims(),i=this.container,s=(n.width*h-i.width)/2,o=(n.height*h-i.height)/2,a=n.width>i.width?n.width-i.width:0,r=n.height>i.height?n.height-i.height:0,"invert"===c?(s+=(i.width-n.width)/2,o+=(i.height-n.height)/2,t[4]=Math.max(Math.min(t[4],s-n.left),-s-n.left-a),t[5]=Math.max(Math.min(t[5],o-n.top),-o-n.top-r)):(t[4]=Math.min(Math.max(t[4],s-n.left-a/2),-s-n.left-a/2),t[5]=Math.min(Math.max(t[5],o-n.top-r/2),-o-n.top-r/2))),Math.abs(2*t[5])>=n.height*(t[3]-1)?this.onYEdge=!0:this.onYEdge=!1,"skip"!==e.animate&&this.transition(!e.animate),e.range&&this.$zoomRange.val(h),$[this.isSVG?"attr":"style"](this.elem,"transform","matrix("+t.join(",")+")"),e.silent||this._trigger("change",t),t}},isPanning:function(){return this.panning},transition:function(t){var e=t||!this.options.transition?"none":this._transition;$.style(this.elem,"transition")!==e&&$.style(this.elem,"transition",e)},pan:function(t,e,n){n||(n={});var i=n.matrix;return i||(i=this.getMatrix()),1==i[0]&&1==i[3]?(this.options.disablePan=!0,void(this.options.silent=!0)):(this.options.disablePan=!1,this.options.silent=!1,n.relative?(i[4]=+i[4]+t,i[5]=+i[5]+e):(i[4]=t,i[5]=e),this.setMatrix(i,n),void(n.silent||this._trigger("pan",t,e)))},zoom:function(t,i){"object"==typeof t?(i=t,t=null):i||(i={});var s=$.extend({},this.options,i);if(!s.disableZoom){var o=!1,a=s.matrix||this.getMatrix();"number"!=typeof t&&(t=+a[0]+s.increment*(t?-1:1),o=!0),t>s.maxScale?t=s.maxScale:t<s.minScale&&(t=s.minScale);var r=s.focal;if(r&&!s.disablePan){o=!1;var h=this.container,c=r.clientX-h.width/2,l=r.clientY-h.height/2,u=new n(c,l,1),m=new e(a),f=this.$parent.offset(),d=new e(1,0,f.left-this.$doc.scrollLeft(),0,1,f.top-this.$doc.scrollTop()),p=m.inverse().x(d.inverse().x(u)),g=t/a[0];m=m.x(new e([g,0,0,g,0,0])),u=d.x(m.x(p)),a[4]=+a[4]+(c-u.e(0)),a[5]=+a[5]+(l-u.e(1))}a[0]=t,a[3]="number"==typeof s.dValue?s.dValue:t,this.setMatrix(a,{animate:"boolean"==typeof s.animate?s.animate:o,range:!s.noSetRange}),s.silent||this._trigger("zoom",t,s)}},option:function(t,e){var n;if(!t)return $.extend({},this.options);if("string"==typeof t){if(1===arguments.length)return this.options[t];n={},n[t]=e}else n=t;this._setOptions(n)},_setOptions:function(t){var e=this;$.each(t,function(t,n){switch(t){case"disablePan":e._resetStyle();case"disableZoom":case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":e._unbind()}switch(e.options[t]=n,t){case"disablePan":e._initStyle();case"disableZoom":case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":e._bind();break;case"cursor":$.style(e.elem,"cursor",n);break;case"minScale":e.$zoomRange.attr("min",n);break;case"maxScale":e.$zoomRange.attr("max",n);break;case"startTransform":e._buildTransform();break;case"duration":case"easing":e._buildTransition();case"transition":e.transition()}})},_initStyle:function(){this.options.disablePan||this.$elem.css("cursor",this.options.cursor);var t=this.$parent;if(t.length&&!$.nodeName(t[0],"body")){var e={overflow:"hidden"};"static"===t.css("position")&&(e.position="relative"),t.css(e)}},_resetStyle:function(){this.$elem.css({cursor:"",transition:""}),this.$parent.css({overflow:"",position:""})},_bind:function(){var t=this,e=this.options,n=e.eventNamespace,i="touchstart"+n+" mousedown"+n,s="touchend"+n+" click"+n,o={},a=this.$reset;if($.each(["Start","Change","Zoom","Pan","End","Reset"],function(){var t=e["on"+this];$.isFunction(t)&&(o["panzoom"+this.toLowerCase()+n]=t)}),e.disablePan&&e.disableZoom||(o[i]=function(n){var i;("mousedown"===n.type?e.disablePan||1!==n.which:!(i=n.touches)||(1!==i.length||e.disablePan)&&2!==i.length)||(n.preventDefault(),n.stopPropagation(),t._startMove(n,i))}),this.$elem.on(o),a.length&&a.on(s,function(e){e.preventDefault(),t.reset()}),!e.disableZoom){var r=this.$zoomIn,h=this.$zoomOut,c=this.$zoomRange;r.length&&h.length&&(r.on(s,function(e){e.preventDefault(),t.zoom()}),h.on(s,function(e){e.preventDefault(),t.zoom(!0)})),c.length&&(c.attr({min:e.minScale,max:e.maxScale,step:.05}).prop({value:this.getMatrix()[0]}),o={},o.mousedown=function(){t.transition(!0)},o["change"+n]=function(){t.zoom(+this.value,{noSetRange:!0})},c.on(o))}},_unbind:function(){this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace)},_buildTransform:function(){return this._origTransform=this.getTransform(this.options.startTransform)},_buildTransition:function(){var t=this.options;this._transform&&(this._transition=this._transform+" "+t.duration+"ms "+t.easing)},_buildContain:function(){var t=this.$parent;this.container={width:t.width(),height:t.height()};var e=this.elem,n=this.$elem;this.dimensions=this.isSVG?{left:e.getAttribute("x")||0,top:e.getAttribute("y")||0,width:e.getAttribute("width")||n.width(),height:e.getAttribute("height")||n.height()}:{left:$.css(e,"left",!0)||0,top:$.css(e,"top",!0)||0,width:n.width(),height:n.height()}},_checkDims:function(){var t=this.dimensions;return t.width&&t.height||this._buildContain(),this.dimensions},_getDistance:function(t){var e=t[0],n=t[1];return Math.sqrt(Math.pow(Math.abs(n.clientX-e.clientX),2)+Math.pow(Math.abs(n.clientY-e.clientY),2))},_getMiddle:function(t){var e=t[0],n=t[1];return{clientX:(n.clientX-e.clientX)/2+e.clientX,clientY:(n.clientY-e.clientY)/2+e.clientY}},_trigger:function(t){this.$elem.triggerHandler("panzoom"+t,[this].concat(a.call(arguments,1)))},_startMove:function(t,e){var n,i,s,o,a,r,h=this,c=this.options,l="touchstart"===t.type,u=c.eventNamespace,m=(l?"touchmove":"mousemove")+u,f=(l?"touchend":"mouseup")+u,d=this.getMatrix(),p=d.slice(0),g=+p[4],v=+p[5],b={matrix:d,animate:"skip"};this.transition(!0),this.panning=!0,this._trigger("start",t,e),e&&2===e.length?(i=this._getDistance(e),s=+d[0],o=this._getMiddle(e),n=function(t){t.preventDefault();var n=h._getMiddle(e=t.touches),a=h._getDistance(e)-i;h.zoom(a*(c.increment/100)+s,{focal:n,matrix:d}),h.pan(+d[4]+n.clientX-o.clientX,+d[5]+n.clientY-o.clientY,b),o=n}):(a=t.pageX,r=t.pageY,n=function(t){t.preventDefault(),h.pan(g+t.pageX-a,v+t.pageY-r,b)}),$(document).off(u).on(m,n).on(f,function(t){t.preventDefault(),$(this).off(u),h.panning=!1,h._trigger("end",d,!!$(p).not(d).length)})}},$.fn.panzoom=function(t){var e,n,s,r;return"string"==typeof t?(r=[],n=a.call(arguments,1),this.each(function(){e=$.data(this,o),e?"_"!==t.charAt(0)&&"function"==typeof(s=e[t])&&void 0!==(s=s.apply(e,n))&&r.push(s):r.push(void 0)}),r.length?1===r.length?r[0]:r:this):this.each(function(){new i(this,t)})},i});