jQuery.fn.attachGoogleNormalizer=function(e){var e=e,t=this,n,a,r=null;if(this.setState=function(e,t){if(!$('select[name*="state"] option[value="'+t+'"]').length)throw"This country is not supported yet.";$('select[name*="state"]').val(t)},this.setCity=function(e,t){""==$('input[name*="city"]').val()&&$('input[name*="city"]').val(t)},this.setCountry=function(e,t){if(!$('select[name*="country"] option[value="'+t+'"]').length)throw"This country is not supported yet.";$('select[name*="country"]').val(t)},this.setZip=function(e,t){$('input[name*="zip"]').val(t)},this.setBuildRoute=function(e,n){"route"==e?t.route=n:t.num=n,void 0!=t.num&&void 0!=t.route&&($('input[name*="street_line1]"]').val(t.num+" "+t.route),t.num=t.route=void 0)},this.displayEditAddress=function(){var e=$("#search_place").val().split(","),t="<div class='alert alert-info' style='margin-top: 10px;'>";t+="<p style='margin: 0;''><b>",t+=$('input[name*="first_name"]').val()+" "+$('input[name*="last_name"]').val(),t+="</b></p>",void 0!=$('input[name*="company"]').val()&&""!=$('input[name*="company"]').val()&&(t+="<p style='margin: 0;''><i>",t+=$('input[name*="company"]').val(),t+="</i></p>"),t+="<p style='margin: 0; margin-top: 10px;'><b>",t+=e[0],t+="</b></p>",t+="<p style='margin: 0;'><i>",t+=$('input[name*="street_line2"]').val(),t+="</i></p>",t+="<p style='margin: 0;'>",t+=e[1]+", "+e[2],t+="</p>",t+="<p style='margin: 0; margin-top: 10px;'><b>",t+=e[3],t+="</b></p>",t+="</div>",$("#search_place").parent().append(t)},this.removeConstraints=function(){$('input[name*="city"]').parsley("removeConstraint","required"),$('input[name*="zip"]').parsley("removeConstraint","required"),$('select[name*="state"]').parsley("removeConstraint","required"),$('select[name*="country"]').parsley("removeConstraint","required"),$('input[name*="street_line1"]').parsley("removeConstraint","required"),$('input[name*="city"]').parent().find(".tooltip, .glyphicon").remove(),$('input[name*="zip"]').parent().find(".tooltip, .glyphicon").remove(),$('select[name*="state"]').parent().find(".tooltip, .glyphicon").remove(),$('select[name*="country"]').parent().find(".tooltip, .glyphicon").remove(),$('input[name*="street_line1"]').parent().find(".tooltip, .glyphicon").remove()},this.addConstraints=function(){$('input[name*="city"]').parsley("addConstraint",{required:!0}),$('input[name*="zip"]').parsley("addConstraint",{required:!0}),$('select[name*="state"]').parsley("addConstraint",{required:!0}),$('select[name*="country"]').parsley("addConstraint",{required:!0}),$('input[name*="street_line1"]').parsley("addConstraint",{required:!0})},this.clearInputs=function(){$('input[name*="city"], input[name*="zip"], input[name*="street_line2"], input[name*="street_line1"]').val("")},this.setSuccess=function(){var e="<div class='alert alert-success' style='margin-top: 10px;'>";e+="Address found:<ul>",e+="<li style='cursor: pointer;' id='google_map_wrapper_more_info'><u>Add more information ?</u></li>",e+="<li style='cursor: pointer;' id='google_map_wrapper_manual'><u>Edit your address manually</u></li>",e+="</ul></div>",$("#search_place").parent().append(e)},this.setErrorNotVierfied=function(){this.clearInputs();var e="<div class='alert alert-warning' style='margin-top: 10px;'>";e+="Impossible to verify this address :<ul>",e+="<li style='cursor: pointer;' id='google_map_wrapper_retype'><u>Retype another address</u></li>",e+="<li style='cursor: pointer;' id='google_map_wrapper_manual'><u>Edit your address manually</u></li>",e+="</ul></div>",$("#search_place").parent().append(e)},this.setError=function(e){t.clearInputs(),$("#search_place").parent().find(".alert").slideUp("fast",function(){this.remove()});var n="<div class='alert alert-danger' style='margin-top: 10px;'>";n+=e+"<ul>",n+="<li style='cursor: pointer;' id='google_map_wrapper_retype'><u>Retype another address</u></li>",n+="<li style='cursor: pointer;' id='google_map_wrapper_manual'><u>Edit your address manually</u></li>",n+="</ul></div>",$("#search_place").parent().removeClass("has-success").addClass("has-error"),$("#search_place").parent().append(n)},this.setAddr=function(e){var n={street_number:["short_name",t.setBuildRoute],route:["long_name",t.setBuildRoute],locality:["long_name",t.setCity],sublocality:["long_name",t.setCity],administrative_area_level_1:["short_name",t.setState],country:["short_name",t.setCountry],postal_code:["short_name",t.setZip]};if(e.address_components)for(var a=0;a<e.address_components.length;a++){var r=e.address_components[a].types[0];n[r]&&n[r][1](r,e.address_components[a][n[r][0]]),t.checkForm(a==e.address_components.length-1)}},this.checkForm=function(e){var t=""==$('input[name*="street_line1"]').val()||""==$('input[name*="zip"]').val()||""==$('input[name*="city"]').val();e&&($("#search_place").parent().find(".alert").slideUp("fast",function(){this.remove()}),t?this.setErrorNotVierfied():this.setSuccess())},"custom-address"===$("#search_place").parent().parent().parent().parent().attr("id")&&(r=$("#search_place").parent().parent().parent().parent(),$("#checkout_shipping_address_id, #checkout_billing_address_id, #express_shipping_address_id").change(function(){""!=$(this).val()?($("#custom-address").slideUp(),$('input[name*="first_name"]').parsley("removeConstraint","required"),$('input[name*="last_name"]').parsley("removeConstraint","required"),$('input[name*="phone_number"]').parsley("removeConstraint","required"),t.removeConstraints()):($("#custom-address").slideDown(),$('input[name*="first_name"]').parsley("addConstraint",{required:!0}),$('input[name*="last_name"]').parsley("addConstraint",{required:!0}),$('input[name*="phone_number"]').parsley("addConstraint",{required:!0}))})),r&&"none"==r.css("display")&&($('input[name*="first_name"]').parsley("removeConstraint","required"),$('input[name*="last_name"]').parsley("removeConstraint","required"),$('input[name*="phone_number"]').parsley("removeConstraint","required"),t.removeConstraints()),$("#search_place").length){$(this).submit(function(){return(!r||"block"!==r.css("display"))&&r||""!=$('input[name*="city"]').val()&&""!=$('input[name*="zip"]').val()&&""!=$('input[name*="street_line_1"]').val()?void 0:($("#search_place").parent().find(".alert").slideUp("fast"),$('input[name*="street_line1]"]').focus(),$('input[name*="city"], input[name*="zip"], select[name*="state"], select[name*="country"], input[name*="street_line1"], input[name*="street_line2"]').parent().parent().slideDown("fast"),t.addConstraints(),!1)}),$(document).on("click","#google_map_wrapper_more_info",function(){$('input[name*="street_line2"]').parent().parent().slideDown("fast",function(){$('input[name*="street_line2"]').focus()})}),$(document).on("click","#google_map_wrapper_retype",function(){$("#search_place").parent().find(".alert").slideUp("fast",function(){$("#search_place").val(""),$("#search_place").focus()})}),$(document).on("click","#google_map_wrapper_manual",function(){$("#search_place").parent().find(".alert").slideUp("fast"),$('input[name*="street_line1]"]').focus(),$('input[name*="city"], input[name*="zip"], select[name*="state"], select[name*="country"], input[name*="street_line1"], input[name*="street_line2"]').parent().parent().slideDown("fast"),t.addConstraints()}),$("#search_place").focus(function(){$("#search_place").bind("keyup keypress",function(e){t.removeConstraints(),$('input[name*="city"], input[name*="zip"], select[name*="state"], select[name*="country"], input[name*="street_line1"], input[name*="street_line2"]').parent().parent().slideUp("fast")}),$("form").bind("keyup keypress",function(e){$("#search_place").parent().removeClass("has_success"),$("#search_place").parent().removeClass("has_error");var t=e.keyCode||e.which;return 13==t?(e.preventDefault(),!1):void 0})}),$("#search_place").blur(function(e){var t=e.keyCode||e.which;return 13==t?(e.preventDefault(),!0):void 0}),$('input[name*="city"], input[name*="zip"], select[name*="state"], select[name*="country"], input[name*="street_line1"], input[name*="street_line2"]').parent().parent().css("display","none"),this.removeConstraints(),""!=$("#search_place").val()&&this.displayEditAddress();var i=new google.maps.places.Autocomplete(document.getElementById("search_place"),{types:["geocode"]});google.maps.event.addListener(i,"place_changed",function(e){var n=i.getPlace();if(n.address_components){t.clearInputs();try{t.setAddr(n)}catch(a){t.setError(a)}}})}};